<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToolCrib Requisitions Pro</title>
    

<script src="https://cdn.tailwindcss.com"></script>
    

<script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary': {
                            '50': '#eff6ff',
                            '100': '#dbeafe',
                            '200': '#bfdbfe',
                            '300': '#93c5fd',
                            '400': '#60a5fa',
                            '500': '#3b82f6',
                            '600': '#2563eb',
                            '700': '#1d4ed8',
                            '800': '#1e40af',
                            '900': '#1e3a8a',
                            '950': '#172554',
                        },
                    },
                    animation: {
                        'fade-in-down': 'fadeInDown 0.5s ease-out',
                        'fade-out-up': 'fadeOutUp 0.5s ease-out forwards',
                    },
                    keyframes: {
                        fadeInDown: {
                            '0%': { opacity: '0', transform: 'translateY(-10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        fadeOutUp: {
                            '0%': { opacity: '1', transform: 'translateY(0)' },
                            '100%': { opacity: '0', transform: 'translateY(-10px)' },
                        },
                    }
                }
            }
        }
    </script>
    

<style>
        /* Estilo para los inputs (siempre visibles) */
        input[type="text"],
        input[type="password"],
        input[type="email"],
        input[type="number"],
        select {
            @apply w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white transition-colors;
        }
        input:read-only {
            @apply bg-gray-100 text-gray-500 cursor-not-allowed;
        }

        /* Estilo para los botones principales */
        .btn {
            @apply px-4 py-2 rounded-md font-medium shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors;
        }
        .btn-primary {
            @apply bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500;
        }
        .btn-secondary {
            @apply bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-primary-500;
        }
        .btn-danger {
            @apply bg-red-600 text-white hover:bg-red-700 focus:ring-red-500;
        }

        /* Estilo para las pestañas de navegación */
        .nav-tab {
            @apply px-4 py-2 font-medium text-gray-500 rounded-t-lg hover:text-gray-700 hover:bg-gray-50 transition-colors;
        }
        .nav-tab.active {
            @apply bg-white text-primary-600 border-t-2 border-l-2 border-r-2 border-gray-200 border-b-white -mb-px z-10;
        }

        /* Transición suave para modales */
        .modal {
            transition: opacity 0.20s ease-in-out;
        }
        .modal-content {
            transition: transform 0.20s ease-in-out, opacity 0.20s ease-in-out;
        }
        .modal.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .modal.hidden .modal-content {
            transform: scale(0.95);
            opacity: 0;
        }

        /* Contenedor de Toasts */
        #toast-container {
            @apply fixed top-5 right-5 z-50 flex flex-col gap-3;
        }
        .toast {
            @apply flex items-center p-4 mb-4 w-full max-w-xs text-gray-500 bg-white rounded-lg shadow dark:text-gray-400 dark:bg-gray-800 border-l-4 animate-fade-in-down;
        }
        .toast-success { @apply border-green-500; }
        .toast-error { @apply border-red-500; }
        .toast-info { @apply border-blue-500; }

        /* Spinner de carga */
        .spinner {
            @apply animate-spin h-5 w-5 text-primary-600;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans antialiased text-gray-900">

    

<div id="toast-container"></div>

    

<div id="app-container" class="min-h-screen flex flex-col">

        

<header class="bg-white shadow-sm sticky top-0 z-10 border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    
                    

<div class="flex-shrink-0 flex items-center">
                        <span class="text-2xl font-bold text-primary-900">ToolCrib Pro</span>
                    </div>

                    

<div class="flex items-center space-x-4">
                        

<span id="user-email-display" class="text-sm text-gray-500 hidden sm:inline-block"></span>
                        
                        

<button id="btn-login-icon" class="text-gray-400 hover:text-primary-600 transition-colors p-1 rounded-full hover:bg-gray-100" title="Iniciar Sesión">
                            

<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-1.007 1.11-.907L12 3.28c.55.1 1.02.565 1.11.907l.095.45c.306.115.61.25.908.4l.43.195c.523.238.982.697 1.119 1.241l.12.51c.264.18.517.388.756.621l.45.419c.47.438.724 1.065.596 1.673l-.12.582c.03.176.05.357.05.541s-.02.365-.05.541l.12.582c.128.608-.126 1.235-.596 1.673l-.45.419c-.24.233-.492.441-.756.621l-.12.51c-.137.544-.596 1.003-1.119 1.241l-.43.195c-.298.15-.602.284-.908.4l-.095.45c-.09.542-.56 1.007-1.11.907L12 20.72c-.55-.1-1.02-.565-1.11-.907l-.095-.45c-.306-.115-.61-.25-.908-.4l-.43-.195c-.523-.238-.982-.697-1.119-1.241l-.12-.51c-.264-.18-.517-.388-.756-.621l-.45-.419c-.47-.438-.724-1.065-.596-1.673l.12-.582c-.03-.176-.05-.357-.05-.541s.02-.365.05-.541l-.12-.582c-.128-.608.126-1.235.596-1.673l.45-.419c.24-.233.492.441.756.621l.12-.51c.137-.544.596-1.003 1.119 1.241l.43.195c.298-.15.602-.284.908-.4l.095-.45Z" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                            </svg>
                        </button>
                        

<button id="btn-logout" class="btn btn-secondary hidden text-sm py-1.5 px-3 flex items-center space-x-1">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9" />
                            </svg>
                            <span>Salir</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        

<main class="flex-grow max-w-7xl w-full mx-auto p-4 sm:p-6 lg:p-8">

            

<div class="mb-6 border-b border-gray-200">
                <nav class="flex -mb-px space-x-4" aria-label="Tabs">
                    <button data-screen="home-screen" class="nav-tab active">Inicio</button>
                    <button data-screen="consultar-screen" class="nav-tab">Consultar</button>
                    <button id="btn-admin-nav" data-screen="admin-screen" class="nav-tab hidden">Administración</button>
                </nav>
            </div>

            

<div id="home-screen" class="screen-content bg-white p-6 sm:p-8 rounded-lg shadow-sm border border-gray-200 animate-fade-in-down">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Bienvenido al Sistema</h1>
                <p class="text-lg text-gray-600 mb-8">Seleccione una opción para comenzar.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <button id="btn-registrar-nav" class="group w-full text-left p-6 bg-gradient-to-br from-primary-500 to-primary-700 text-white rounded-xl shadow-md hover:shadow-lg transition-all transform hover:-translate-y-1">
                        <div class="flex items-center justify-between mb-4">
                            

<div class="p-3 bg-white/20 rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-white">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                </svg>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-white/50 group-hover:translate-x-1 transition-transform">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                            </svg>
                        </div>
                        <h2 class="text-2xl font-semibold mb-1">Registrar Requisición</h2>
                        <p class="text-primary-100">Crear una nueva solicitud de artículo.</p>
                    </button>
                    <button data-screen-nav="consultar-screen" class="group w-full text-left p-6 bg-white text-gray-900 rounded-xl shadow-sm hover:shadow-md border border-gray-200 transition-all transform hover:-translate-y-1">
                        <div class="flex items-center justify-between mb-4">
                            

<div class="p-3 bg-primary-50 rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-primary-600">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 1.875 1.875v12.75a1.875 1.875 0 0 1-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V6.375a1.875 1.875 0 0 1 1.875-1.875Z" />
                                </svg>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-gray-400 group-hover:translate-x-1 transition-transform">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                            </svg>
                        </div>
                        <h2 class="text-2xl font-semibold mb-1">Consultar Requisiciones</h2>
                        <p class="text-gray-500">Ver historial y estado de solicitudes.</p>
                    </button>
                </div>
            </div>

            

<div id="consultar-screen" class="screen-content hidden bg-white p-6 sm:p-8 rounded-lg shadow-sm border border-gray-200 animate-fade-in-down">
                <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
                    <h1 class="text-2xl font-bold text-gray-900">Historial de Requisiciones</h1>
                    

<div class="relative w-full sm:w-64">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                        </div>
                        <input type="search" id="search-input" class="block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-primary-500 focus:border-primary-500" placeholder="Buscar por nombre, ID o artículo...">
                    </div>
                </div>

                <div class="overflow-x-auto border rounded-lg">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No. Emp</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nombre</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Artículo</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estatus</th>
                            </tr>
                        </thead>
                        <tbody id="tbody-requisiciones" class="bg-white divide-y divide-gray-200">
                            

<tr>
                                <td colspan="5" class="px-6 py-12 text-center text-gray-500">
                                    <div class="flex justify-center items-center flex-col">
                                        <svg class="animate-spin h-8 w-8 text-primary-500 mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                        <p>Cargando requisiciones...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            

<div id="admin-screen" class="screen-content hidden animate-fade-in-down">
                <h1 class="text-2xl font-bold text-gray-900 mb-6">Panel de Administración</h1>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    
                    

<div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mr-2 text-primary-600">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
                            </svg>
                            Empleados
                        </h2>
                        

<form id="form-add-empleado" class="mb-6 flex gap-2">
                            <div class="flex-1">
                                <input type="number" id="admin-emp-id" name="admin-emp-id" placeholder="No. Empleado" required class="mb-2 sm:mb-0">
                            </div>
                            <div class="flex-[2]">
                                <input type="text" id="admin-emp-nombre" name="admin-emp-nombre" placeholder="Nombre Completo" required>
                            </div>
                            <button type="submit" class="btn btn-primary flex-shrink-0 px-3" title="Agregar Empleado">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                </svg>
                            </button>
                        </form>
                        

<div class="mt-4">
                            <h3 class="text-sm font-medium text-gray-500 uppercase mb-2">Lista Registrada</h3>
                            <div id="admin-list-empleados" class="max-h-80 overflow-y-auto bg-gray-50 rounded-md border border-gray-200 divide-y divide-gray-200">
                                

<div class="p-4 text-center text-gray-500 flex justify-center">
                                    <svg class="animate-spin h-5 w-5 text-gray-400 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                    Cargando...
                                </div>
                            </div>
                        </div>
                    </div>

                    

<div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mr-2 text-primary-600">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z" />
                            </svg>
                            Artículos
                        </h2>
                        

<form id="form-add-articulo" class="mb-6 flex gap-2">
                            <div class="flex-grow">
                                <input type="text" id="admin-art-nombre" name="admin-art-nombre" placeholder="Nombre del Artículo" required>
                            </div>
                            <button type="submit" class="btn btn-primary flex-shrink-0 px-3" title="Agregar Artículo">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                </svg>
                            </button>
                        </form>
                        

<div class="mt-4">
                            <h3 class="text-sm font-medium text-gray-500 uppercase mb-2">Lista Registrada</h3>
                            <div id="admin-list-articulos" class="max-h-80 overflow-y-auto bg-gray-50 rounded-md border border-gray-200 divide-y divide-gray-200">
                                

<div class="p-4 text-center text-gray-500 flex justify-center">
                                    <svg class="animate-spin h-5 w-5 text-gray-400 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                    Cargando...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    

<div id="registrar-modal" class="modal hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-center z-50 p-4">
        <div class="modal-content bg-white rounded-xl shadow-2xl p-6 sm:p-8 w-full max-w-md relative transform scale-95 opacity-0 transition-all">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900">Nueva Requisición</h2>
                <button data-dismiss="modal" class="text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100">
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <form id="form-registrar" class="space-y-5">
                <div>
                    <label for="reg-empleado-id" class="block text-sm font-medium text-gray-700 mb-1">Número de Empleado</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-gray-400">
                              <path fill-rule="evenodd" d="M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm-5.5-2.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0ZM10 12a5.99 5.99 0 0 0-4.793 2.39A9.916 9.916 0 0 0 10 18c2.314 0 4.438-.784 6.131-2.1.43-.333-.604-2.472-1.338-3.51Zm0-8a6 6 0 0 1 6 6 9.97 9.97 0 0 1-1.409 4.966l.004.007A7.95 7.95 0 0 0 10 4.05V4Z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <input type="number" id="reg-empleado-id" name="reg-empleado-id" required class="pl-10" placeholder="Ingrese ID...">
                    </div>
                </div>
                <div>
                    <label for="reg-nombre" class="block text-sm font-medium text-gray-700 mb-1">Nombre</label>
                    <input type="text" id="reg-nombre" name="reg-nombre" readonly placeholder="Se rellena automáticamente...">
                </div>
                <div>
                    <label for="reg-articulo" class="block text-sm font-medium text-gray-700 mb-1">Artículo</label>
                    <select id="reg-articulo" name="reg-articulo" required>
                        <option value="">Seleccione un artículo...</option>
                        

</select>
                </div>
                <div>
                    <label for="reg-fecha" class="block text-sm font-medium text-gray-700 mb-1">Fecha</label>
                    <input type="text" id="reg-fecha" name="reg-fecha" readonly>
                </div>
                
                <div class="pt-4 flex justify-end space-x-3">
                    <button type="button" data-dismiss="modal" class="btn btn-secondary">Cancelar</button>
                    <button type="submit" class="btn btn-primary w-full sm:w-auto">Registrar</button>
                </div>
            </form>
        </div>
    </div>

    

<div id="login-modal" class="modal hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-center z-50 p-4">
        <div class="modal-content bg-white rounded-xl shadow-2xl p-6 sm:p-8 w-full max-w-sm relative transform scale-95 opacity-0 transition-all">
            <div class="text-center mb-8">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-primary-100 rounded-full mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-primary-600">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z" />
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">Acceso Administrador</h2>
                <p class="text-gray-500 text-sm mt-1">Ingrese sus credenciales para continuar.</p>
            </div>
            
            <form id="form-login" class="space-y-5">
                <div>
                    <label for="login-email" class="block text-sm font-medium text-gray-700 mb-1">Correo Electrónico</label>
                    <input type="email" id="login-email" name="login-email" required placeholder="admin@toolcrib.com" autocomplete="email">
                </div>
                <div>
                    <div class="flex justify-between mb-1">
                        <label for="login-pass" class="block text-sm font-medium text-gray-700">Contraseña</label>
                    </div>
                    <input type="password" id="login-pass" name="login-pass" required placeholder="••••••••" autocomplete="current-password">
                </div>
                
                <div class="pt-4 flex flex-col space-y-3">
                    <button type="submit" id="btn-login-submit" class="btn btn-primary w-full flex justify-center items-center">
                        <span>Entrar</span>
                         

<svg id="login-spinner" class="hidden animate-spin ml-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                    </button>
                    <button type="button" data-dismiss="modal" class="btn btn-secondary w-full">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    

<div id="status-modal" class="modal hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-center z-50 p-4">
        <div class="modal-content bg-white rounded-xl shadow-2xl p-6 w-full max-w-sm relative transform scale-95 opacity-0 transition-all text-center">
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Actualizar Estatus</h3>
            <p class="text-sm text-gray-500 mb-6">Seleccione el nuevo estado para esta requisición.</p>
            
            <div class="space-y-3">
                <button id="btn-status-auth" class="w-full py-3 px-4 rounded-lg font-medium bg-green-50 text-green-700 hover:bg-green-100 border border-green-200 transition-colors flex items-center justify-center">
                    <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span> Autorizada
                </button>
                <button id="btn-status-cobrada" class="w-full py-3 px-4 rounded-lg font-medium bg-blue-50 text-blue-700 hover:bg-blue-100 border border-blue-200 transition-colors flex items-center justify-center">
                    <span class="w-3 h-3 bg-blue-500 rounded-full mr-2"></span> Cobrada
                </button>
                <button id="btn-status-pendiente" class="w-full py-3 px-4 rounded-lg font-medium bg-yellow-50 text-yellow-700 hover:bg-yellow-100 border border-yellow-200 transition-colors flex items-center justify-center">
                    <span class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></span> Pendiente
                </button>
                <button data-dismiss="modal" class="btn btn-secondary w-full mt-2">Cancelar</button>
            </div>
        </div>
    </div>

    

<div id="confirm-modal" class="modal hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-center z-50 p-4">
        <div class="modal-content bg-white rounded-xl shadow-2xl p-6 w-full max-w-sm relative transform scale-95 opacity-0 transition-all">
            <div class="flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-red-600">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
                </svg>
            </div>
            <div class="text-center mb-6">
                <h3 id="confirm-title" class="text-lg font-semibold text-gray-900">¿Estás seguro?</h3>
                <p id="confirm-message" class="text-sm text-gray-500 mt-2">Esta acción no se puede deshacer.</p>
            </div>
            <div class="flex space-x-3">
                <button id="btn-confirm-cancel" class="btn btn-secondary flex-1">Cancelar</button>
                <button id="btn-confirm-ok" class="btn btn-danger flex-1">Sí, eliminar</button>
            </div>
        </div>
    </div>


    

<script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { 
            getAuth, 
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { 
            getFirestore, doc, addDoc, updateDoc, deleteDoc, onSnapshot, collection, setLogLevel 
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- CONFIGURACIÓN DE FIREBASE ---
        const firebaseConfig = {
          apiKey: "AIzaSyDahnSPvBNTYot00JCn5CBjggAYFVGhbjE",
          authDomain: "panel-logistica-simple.firebaseapp.com",
          databaseURL: "https://panel-logistica-simple-default-rtdb.firebaseio.com",
          projectId: "panel-logistica-simple",
          storageBucket: "panel-logistica-simple.firebasestorage.app",
          messagingSenderId: "528779971851",
          appId: "1:528779971851:web:29ed933e7c7fd997a4e60e"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Colecciones
        const requisitionsCollection = collection(db, 'requi_toolcrib', 'data', 'requisitions');
        const employeesCollection = collection(db, 'requi_toolcrib', 'data', 'employees');
        const articlesCollection = collection(db, 'requi_toolcrib', 'data', 'articles');

        // Estado Global
        let currentUser = null;
        let currentEditingRequisitionId = null;
        let confirmCallback = null; // Para el modal de confirmación
        let requisitionsData = []; // Copia local para filtrado

        // Mapas para caché
        let empleadosMap = new Map();
        let articulosMap = new Map();

        // Referencias DOM (UI Elements)
        const toastContainer = document.getElementById('toast-container');
        const btnLoginIcon = document.getElementById('btn-login-icon');
        const btnLogout = document.getElementById('btn-logout');
        const userEmailDisplay = document.getElementById('user-email-display');
        const btnAdminNav = document.getElementById('btn-admin-nav');
        
        const loginModal = document.getElementById('login-modal');
        const loginEmailInput = document.getElementById('login-email');
        const loginPassInput = document.getElementById('login-pass');
        const btnLoginSubmit = document.getElementById('btn-login-submit');
        const loginSpinner = document.getElementById('login-spinner');

        const tbodyRequisiciones = document.getElementById('tbody-requisiciones');
        const searchInput = document.getElementById('search-input');

        const adminListEmpleados = document.getElementById('admin-list-empleados');
        const adminListArticulos = document.getElementById('admin-list-articulos');
        
        const confirmModal = document.getElementById('confirm-modal');
        const confirmTitle = document.getElementById('confirm-title');
        const confirmMessage = document.getElementById('confirm-message');
        const btnConfirmOk = document.getElementById('btn-confirm-ok');
        const btnConfirmCancel = document.getElementById('btn-confirm-cancel');

        // --- FUNCIONES DE UI (TOASTS & MODALES) ---

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            let iconSvg = '';
            if (type === 'success') {
                iconSvg = '<svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>';
            } else if (type === 'error') {
                iconSvg = '<svg class="w-5 h-5 text-red-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>';
            } else {
                 iconSvg = '<svg class="w-5 h-5 text-blue-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zm-1 9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>';
            }

            toast.innerHTML = `${iconSvg}<div class="text-sm font-normal">${message}</div>`;
            toastContainer.appendChild(toast);

            setTimeout(() => {
                toast.classList.replace('animate-fade-in-down', 'animate-fade-out-up');
                setTimeout(() => toast.remove(), 500);
            }, 3000);
        }

        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (!modal) return;
            modal.classList.remove('hidden');
            void modal.offsetWidth; 
            modal.querySelector('.modal-content').classList.add('opacity-100', 'scale-100');
            modal.classList.remove('opacity-0');
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (!modal) return;
            modal.querySelector('.modal-content').classList.remove('opacity-100', 'scale-100');
            modal.classList.add('opacity-0');
            setTimeout(() => modal.classList.add('hidden'), 200);
        }

        function askConfirmation(title, message, callback) {
            confirmTitle.textContent = title;
            confirmMessage.textContent = message;
            confirmCallback = callback;
            openModal('confirm-modal');
        }

        // --- AUTENTICACIÓN ---

        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            if (user) {
                // Usuario Logueado
                console.log("Usuario conectado:", user.email);
                btnLoginIcon.classList.add('hidden');
                btnLogout.classList.remove('hidden');
                userEmailDisplay.textContent = user.email;
                userEmailDisplay.classList.remove('hidden');
                btnAdminNav.classList.remove('hidden');
            } else {
                // Usuario Desconectado
                console.log("Usuario desconectado");
                btnLoginIcon.classList.remove('hidden');
                btnLogout.classList.add('hidden');
                userEmailDisplay.classList.add('hidden');
                btnAdminNav.classList.add('hidden');
                // Si estaba en admin, volver a home
                if (!document.getElementById('admin-screen').classList.contains('hidden')) {
                    document.querySelector('[data-screen="home-screen"]').click();
                }
            }
            renderRequisitions(); // Re-renderizar para actualizar permisos de UI
            renderAdminLists();   // Re-renderizar listas de admin
        });

        async function handleLogin(e) {
            e.preventDefault();
            const email = loginEmailInput.value;
            const password = loginPassInput.value;

            btnLoginSubmit.disabled = true;
            loginSpinner.classList.remove('hidden');

            try {
                await signInWithEmailAndPassword(auth, email, password);
                closeModal('login-modal');
                showToast(`Bienvenido, ${email}`);
                loginEmailInput.value = '';
                loginPassInput.value = '';
            } catch (error) {
                console.error("Error de login:", error);
                let msg = "Error al iniciar sesión.";
                if (error.code === 'auth/invalid-credential') msg = "Correo o contraseña incorrectos.";
                if (error.code === 'auth/too-many-requests') msg = "Demasiados intentos. Espere un momento.";
                showToast(msg, 'error');
            } finally {
                btnLoginSubmit.disabled = false;
                loginSpinner.classList.add('hidden');
            }
        }

        async function handleLogout() {
            try {
                await signOut(auth);
                showToast("Sesión cerrada correctamente.", 'info');
            } catch (error) {
                console.error("Error al cerrar sesión:", error);
            }
        }

        // --- FIRESTORE DATA HANDLERS ---

        // 1. Requisiciones (Público - Lectura)
        onSnapshot(requisitionsCollection, (snapshot) => {
            requisitionsData = [];
            snapshot.forEach((doc) => requisitionsData.push({ id: doc.id, ...doc.data() }));
            requisitionsData.sort((a, b) => b.fecha.localeCompare(a.fecha)); // Ordenar por fecha desc
            filterAndRenderRequisitions();
        }, (error) => {
            console.error("Error requisiciones:", error);
            // Si el error es de permisos, mostramos lista vacía en vez de spinner eterno
            if (error.code === 'permission-denied') {
                 tbodyRequisiciones.innerHTML = `<tr><td colspan="5" class="p-8 text-center text-gray-500">No tienes permisos para ver las requisiciones.</td></tr>`;
            }
        });

        // 2. Empleados (Público - Lectura para autocompletar, Escritura protegida)
        onSnapshot(employeesCollection, (snapshot) => {
            empleadosMap.clear();
            snapshot.forEach((doc) => empleadosMap.set(doc.data().id, { ...doc.data(), fbId: doc.id }));
            renderAdminLists();
        });

        // 3. Artículos (Igual que empleados)
        onSnapshot(articlesCollection, (snapshot) => {
            articulosMap.clear();
            snapshot.forEach((doc) => articulosMap.set(doc.data().nombre, { ...doc.data(), fbId: doc.id }));
            renderArticulosDropdown();
            renderAdminLists();
        });

        // --- RENDERING UI ---

        function filterAndRenderRequisitions() {
            const term = searchInput.value.toLowerCase();
            const filtered = requisitionsData.filter(req => 
                req.nombre.toLowerCase().includes(term) ||
                req.empleadoId.toString().includes(term) ||
                req.articulo.toLowerCase().includes(term)
            );
            renderRequisitions(filtered);
        }

        function renderRequisitions(data = requisitionsData) {
            if (data.length === 0) {
                tbodyRequisiciones.innerHTML = `<tr><td colspan="5" class="p-8 text-center text-gray-500 italic">No se encontraron requisiciones.</td></tr>`;
                return;
            }

            tbodyRequisiciones.innerHTML = data.map(req => {
                let statusColor = 'bg-yellow-100 text-yellow-800 border-yellow-200';
                if (req.status === 'Autorizada') statusColor = 'bg-green-100 text-green-800 border-green-200';
                if (req.status === 'Cobrada') statusColor = 'bg-blue-100 text-blue-800 border-blue-200';

                const isClickable = currentUser ? 'cursor-pointer hover:scale-105' : 'cursor-default opacity-90';
                const title = currentUser ? 'Clic para cambiar estatus' : '';

                return `
                    <tr class="hover:bg-gray-50 transition-colors">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${req.fecha}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${req.empleadoId}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${req.nombre}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${req.articulo}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span data-id="${req.id}" class="status-badge px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full border ${statusColor} transition-transform ${isClickable}" title="${title}">
                                ${req.status}
                            </span>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function renderAdminLists() {
            // Render Empleados
            if (empleadosMap.size === 0) {
                adminListEmpleados.innerHTML = '<div class="p-4 text-center text-gray-500 italic">Sin empleados registrados.</div>';
            } else {
                const sorted = Array.from(empleadosMap.values()).sort((a, b) => a.id - b.id);
                adminListEmpleados.innerHTML = sorted.map(emp => `
                    <div class="flex justify-between items-center p-3 hover:bg-white transition-colors">
                        <div>
                            <span class="font-medium text-gray-900">${emp.id}</span>
                            <span class="text-gray-500 ml-2">— ${emp.nombre}</span>
                        </div>
                        <button class="btn-delete-emp text-gray-400 hover:text-red-600 p-1 transition-colors" data-fbid="${emp.fbId}" data-name="${emp.nombre}">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" /></svg>
                        </button>
                    </div>
                `).join('');
            }

            // Render Artículos
            if (articulosMap.size === 0) {
                adminListArticulos.innerHTML = '<div class="p-4 text-center text-gray-500 italic">Sin artículos registrados.</div>';
            } else {
                const sorted = Array.from(articulosMap.values()).sort((a, b) => a.nombre.localeCompare(b.nombre));
                adminListArticulos.innerHTML = sorted.map(art => `
                    <div class="flex justify-between items-center p-3 hover:bg-white transition-colors">
                        <span class="text-gray-700">${art.nombre}</span>
                        <button class="btn-delete-art text-gray-400 hover:text-red-600 p-1 transition-colors" data-fbid="${art.fbId}" data-name="${art.nombre}">
                           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" /></svg>
                        </button>
                    </div>
                `).join('');
            }
        }

        function renderArticulosDropdown() {
            const select = document.getElementById('reg-articulo');
            const currentVal = select.value;
            let html = '<option value="">Seleccione un artículo...</option>';
            
            const sorted = Array.from(articulosMap.keys()).sort();
            sorted.forEach(nombre => {
                html += `<option value="${nombre}">${nombre}</option>`;
            });
            select.innerHTML = html;
            select.value = currentVal; // Intentar mantener selección si existe
        }

        // --- EVENT LISTENERS ---

        document.addEventListener('DOMContentLoaded', () => {
            // Navegación
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.screen-content').forEach(s => s.classList.add('hidden'));
                    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                    document.getElementById(tab.dataset.screen).classList.remove('hidden');
                    tab.classList.add('active');
                });
            });

            document.querySelectorAll('[data-screen-nav]').forEach(btn => {
                btn.addEventListener('click', () => document.querySelector(`.nav-tab[data-screen="${btn.dataset.screenNav}"]`).click());
            });

            // Modales
            document.querySelectorAll('[data-dismiss="modal"]').forEach(btn => {
                btn.addEventListener('click', () => closeModal(btn.closest('.modal').id));
            });

            document.getElementById('btn-registrar-nav').addEventListener('click', () => {
                document.getElementById('reg-fecha').value = new Date().toISOString().split('T')[0];
                openModal('registrar-modal');
            });

            btnLoginIcon.addEventListener('click', () => openModal('login-modal'));
            document.getElementById('form-login').addEventListener('submit', handleLogin);
            btnLogout.addEventListener('click', handleLogout);

            // Búsqueda
            searchInput.addEventListener('input', filterAndRenderRequisitions);

            // Autocompletado Empleado
            document.getElementById('reg-empleado-id').addEventListener('input', (e) => {
                const empData = empleadosMap.get(e.target.value);
                document.getElementById('reg-nombre').value = empData ? empData.nombre : '';
            });

            // Formularios Submit
            document.getElementById('form-registrar').addEventListener('submit', async (e) => {
                e.preventDefault();
                const form = e.target;
                if (!form['reg-nombre'].value) return showToast('Número de empleado no válido', 'error');
                
                try {
                    await addDoc(requisitionsCollection, {
                        empleadoId: form['reg-empleado-id'].value,
                        nombre: form['reg-nombre'].value,
                        articulo: form['reg-articulo'].value,
                        fecha: form['reg-fecha'].value,
                        status: 'Pendiente'
                    });
                    showToast('Requisición registrada correctamente');
                    closeModal('registrar-modal');
                    form.reset();
                } catch (err) { console.error(err); showToast('Error al registrar', 'error'); }
            });

            document.getElementById('form-add-empleado').addEventListener('submit', async (e) => {
                e.preventDefault();
                if (!currentUser) return showToast('Debes iniciar sesión como administrador', 'error');
                const id = document.getElementById('admin-emp-id').value;
                if (empleadosMap.has(id)) return showToast('Este ID de empleado ya existe', 'error');

                try {
                    await addDoc(employeesCollection, { id, nombre: document.getElementById('admin-emp-nombre').value });
                    showToast('Empleado agregado');
                    e.target.reset();
                } catch (err) { console.error(err); showToast('Error al guardar empleado', 'error'); }
            });

            document.getElementById('form-add-articulo').addEventListener('submit', async (e) => {
                e.preventDefault();
                if (!currentUser) return showToast('Debes iniciar sesión como administrador', 'error');
                const nombre = document.getElementById('admin-art-nombre').value.trim();
                if (articulosMap.has(nombre)) return showToast('Este artículo ya existe', 'error');

                try {
                    await addDoc(articlesCollection, { nombre });
                    showToast('Artículo agregado');
                    e.target.reset();
                } catch (err) { console.error(err); showToast('Error al guardar artículo', 'error'); }
            });

            // Delegación de eventos para listas dinámicas
            tbodyRequisiciones.addEventListener('click', (e) => {
                const badge = e.target.closest('.status-badge');
                if (badge && currentUser) {
                    currentEditingRequisitionId = badge.dataset.id;
                    openModal('status-modal');
                }
            });

            // Manejadores para eliminar (Admin)
            adminListEmpleados.addEventListener('click', (e) => {
                const btn = e.target.closest('.btn-delete-emp');
                if (btn) {
                    askConfirmation('Eliminar Empleado', `¿Eliminar a ${btn.dataset.name}?`, async () => {
                        await deleteDoc(doc(employeesCollection, btn.dataset.fbid));
                        showToast('Empleado eliminado');
                    });
                }
            });

            adminListArticulos.addEventListener('click', (e) => {
                const btn = e.target.closest('.btn-delete-art');
                if (btn) {
                    askConfirmation('Eliminar Artículo', `¿Eliminar "${btn.dataset.name}"?`, async () => {
                        await deleteDoc(doc(articlesCollection, btn.dataset.fbid));
                        showToast('Artículo eliminado');
                    });
                }
            });

            // Confirmación Modal Actions
            btnConfirmOk.addEventListener('click', () => {
                if (confirmCallback) confirmCallback();
                closeModal('confirm-modal');
            });
            btnConfirmCancel.addEventListener('click', () => closeModal('confirm-modal'));

            // Botones de estatus
            const updateStatus = async (status) => {
                if (!currentEditingRequisitionId) return;
                try {
                    await updateDoc(doc(requisitionsCollection, currentEditingRequisitionId), { status });
                    showToast(`Estatus actualizado a: ${status}`);
                    closeModal('status-modal');
                } catch (err) { console.error(err); showToast('Error al actualizar estatus', 'error'); }
            };
            document.getElementById('btn-status-auth').addEventListener('click', () => updateStatus('Autorizada'));
            document.getElementById('btn-status-cobrada').addEventListener('click', () => updateStatus('Cobrada'));
            document.getElementById('btn-status-pendiente').addEventListener('click', () => updateStatus('Pendiente'));
        });
    </script>
</body>
</html>
